<!DOCTYPE html>
<html lang="ja">
  <head>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io.connect('http://localhost:8080')
      , user;

      socket.on('connect', function(){
        //クライアント側でkey requestイベント発火
        socket.emit('key request');
        //keyを受信
        socket.on('key push',function(key){
          console.log("client: 受け取ったkey:"+key);
          user = io.connect('http://localhost:8080/'+key);
          console.log(user);
        });

      });

      user.on('connect',function(){
        console.log("client: user.on実行");
        user.emit('msg send','userhoge');
      });
      
    </script>
    <meta charset="UTF-8">
    <title>socket.ioとExpressの組み合わせ </title>
  </head>
  <body>
    起動中(｀・ω・´)
    <h1>socket.ioのサンプルプログラム</h1>
  </body>
</html>



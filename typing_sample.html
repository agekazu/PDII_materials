<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>typing_sample</title>
    <script language="JavaScript">
      var canvas;
      var context;
      //画面に表示する文字列のオブジェクト群
      var characterList= new Array();
      //入力済みの文字列
      var input = new String();
      //入力すべき文字の位置
      var charNumber;
      //問題文を格納
      var text;

      onload = function(){
        init();
      }

      onkeydown= function(){
      console.log("hogehoge");
      whatKey();
      }

      function init(){
      canvas = document.getElementById("typing_Canvas");
      canvas.width  = 1000;
      canvas.height = 600;
      context = canvas.getContext('2d');
      charNumber = 0;
      text = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      //問題文
      characterList.push = (new character("#00000","20pt Osaka",text,200,40,500,20));
      //出題文字
      characterList.push = 
      (new character("#000000","20pt Osaka","出題文字=> " + text.charAt(charNumber),200,120,500,20));
      }

      //文字を配置するメソッド
      function character(_color,_font,_text,_x,_y,_width,_height){
      this.text = _text;
      this.x = _x;
      this.y = _y;
      this.width = _width;
      this.height = _height;
      this.color = _color;
      context.fillStyle = _color;
      context.font = _font;
      //文字を描画
      context.fillText(this.text,this.x,this.y,this.width,this.height);            
      }

      //入力文字と出題文字が同じかを確かめるメソッド
      function whatKey(){
      //charNumber文字目の文字列のUnicode値を得る
      this.a_char=text.charAt(charNumber);
      this.a_char
      console.log("出題文字=> " + this.a_char);
      console.log("入力された文字=> " + String.fromCharCode(event.keyCode));

      //正しい入力か？
      if(String.fromCharCode(event.keyCode) == this.a_char){
      console.log("正解です");
      repaint();
      }else {
      console.log("違います");
      }
      }

      //正しい入力時に、文字の色を変える
      function repaint(){
      var cl=characterList.length;
      //一度クリアに
      context.clearRect(0,0,1000,600);
      characterList[0] = (new character("#00000","20pt Osaka",text,200,40,500,20));
      //入力済み文字列に加える
      input += this.a_char
      //入力済みの文字列を灰色に描画
      characterList[cl] = (new character("#7d7d7d","20pt Osaka",input,200,40,500,20));
      charNumber++;
      //次の文字を出題文字として出力
      characterList[cl+1](new character("#000000","20pt Osaka","出題文字=> " + text.charAt(charNumber),200,120,500,20));
      }

    </script>
    <body>
      <canvas id="typing_Canvas" ></canvas>
    </body>
  </html>

